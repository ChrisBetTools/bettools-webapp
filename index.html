<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BetTools • V3 • NEXT • Stake v1 • UI v1.5</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

<style>
/* =========================
   THEME
========================= */
:root{
  --bg:#070c17;
  --panel:#0e1526;
  --card:#121b2e;
  --border:rgba(255,255,255,.08);
  --text:#e5e7eb;
  --muted:#9ca3af;
  --green:#34d399;
  --red:#fb7185;
  --yellow:#fbbf24;
  --blue:#60a5fa;
  --radius:18px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,system-ui;
  background:var(--bg);
  color:var(--text);
}
button,input,select,textarea{
  background:#0f172a;
  border:1px solid var(--border);
  border-radius:14px;
  color:var(--text);
  padding:12px;
  font-size:15px;
}
button{cursor:pointer;font-weight:700}
button.primary{background:rgba(52,211,153,.15);border-color:rgba(52,211,153,.35)}
button.blue{background:rgba(96,165,250,.15);border-color:rgba(96,165,250,.35)}
button.danger{background:rgba(251,113,133,.15);border-color:rgba(251,113,133,.35)}
.container{max-width:1100px;margin:0 auto;padding:14px}

/* =========================
   TOP BAR
========================= */
.topbar{
  position:sticky;top:0;z-index:50;
  display:flex;justify-content:space-between;align-items:center;
  padding:14px;
  background:#070c17;
  border-bottom:1px solid var(--border);
}
.brand .title{font-size:22px;font-weight:900}
.brand .sub{font-size:13px;color:var(--muted)}
.dayBox{
  padding:8px 14px;border-radius:999px;
  border:1px solid var(--border);
  font-weight:800;
}

/* =========================
   BET CARD (UNIFIED)
========================= */
.betCard{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:14px;
  border-radius:18px;
  border:1px solid var(--border);
  background:#0f172a;
}
.betLeft{min-width:0}
.betTop{font-size:13px;color:var(--muted);font-weight:800}
.betTag{
  display:inline-block;
  padding:6px 10px;
  border-radius:12px;
  background:rgba(255,255,255,.05);
  border:1px solid var(--border);
  margin-right:6px;
}
.betMatch{
  font-size:17px;font-weight:900;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.betPick{
  font-size:14px;color:var(--muted);
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.betRight{text-align:right}
.resWon{color:var(--green);font-weight:900}
.resLost{color:var(--red);font-weight:900}
.resPend{color:var(--yellow);font-weight:900}
.actions{margin-top:10px;display:flex;gap:8px;justify-content:flex-end}

/* =========================
   PAGES
========================= */
.page{display:none}
.page.active{display:block}
.sectionTitle{font-size:26px;font-weight:900;margin:10px 0}
.sectionSub{color:var(--muted);margin-bottom:14px}

/* =========================
   KPI GRID
========================= */
.kpiGrid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.kpi{
  background:#0f172a;
  border:1px solid var(--border);
  border-radius:16px;
  padding:14px;
}
.kpi .label{font-size:13px;color:var(--muted)}
.kpi .value{font-size:26px;font-weight:900}

/* =========================
   MODAL
========================= */
.modalBg{
  position:fixed;inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:flex-end;
  justify-content:center;
  z-index:100;
}
.modal{
  background:#0f172a;
  border-radius:20px;
  width:min(900px,100%);
  max-height:85vh;
  overflow:auto;
  padding:16px;
}
.modal h3{margin-top:0}
</style>
</head>

<body>
<div class="topbar">
  <div class="brand">
    <div class="title">BetTools</div>
    <div class="sub">V3 • NEXT • Stake v1 • UI v1.5</div>
  </div>
  <div class="dayBox" id="dayBox">Giornata: neutra</div>
</div>

<div class="container">

<!-- DASHBOARD -->
<section id="page-dashboard" class="page active">
  <h2 class="sectionTitle">Dashboard</h2>

  <!-- KPI ROW 1 -->
  <div class="kpiGrid">
    <div class="kpi"><div class="label">Bet chiuse</div><div class="value" id="kpiClosed">0</div></div>
    <div class="kpi"><div class="label">Win rate</div><div class="value" id="kpiWR">0%</div></div>
  </div>

  <!-- KPI ROW 2 -->
  <div class="kpiGrid" style="margin-top:10px">
    <div class="kpi"><div class="label">Profitto</div><div class="value" id="kpiProfit">0</div></div>
    <div class="kpi"><div class="label">ROI</div><div class="value" id="kpiROI">0%</div></div>
  </div>

  <!-- KPI ROW 3 -->
  <div class="kpiGrid" style="margin-top:10px">
    <div class="kpi"><div class="label">Max Drawdown</div><div class="value" id="kpiDD">0</div></div>
    <div class="kpi"><div class="label">Streak W/L</div><div class="value" id="kpiStreak">0 / 0</div></div>
  </div>

  <h3 style="margin-top:24px">Latest Bets</h3>
  <div id="latestList" style="display:flex;flex-direction:column;gap:10px"></div>
</section>

<!-- STORICO -->
<section id="page-history" class="page">
  <h2 class="sectionTitle">Storico</h2>
  <p class="sectionSub">Grafica identica a Latest Bets</p>
  <div id="historyList" style="display:flex;flex-direction:column;gap:10px"></div>
</section>

</div>

<!-- MODAL -->
<div class="modalBg" id="modalBg">
  <div class="modal">
    <h3 id="modalTitle"></h3>
    <div id="modalBody"></div>
    <button onclick="closeModal()" style="margin-top:14px">Chiudi</button>
  </div>
</div>

<script>
/* =========================
   MOCK STORAGE (demo)
========================= */
const bets = JSON.parse(localStorage.getItem("bets")||"[]");

/* =========================
   RENDER BET CARD (UNIFIED)
========================= */
function betCardHTML(b, withActions=false){
  let profit = 0;
  if(b.outcome==="won") profit = +(b.stake*(b.odds-1)).toFixed(2);
  if(b.outcome==="lost") profit = -b.stake;

  let cls="resPend", txt="Pending";
  if(b.outcome==="won"){cls="resWon";txt="+"+profit}
  if(b.outcome==="lost"){cls="resLost";txt=profit}

  return `
  <div class="betCard">
    <div class="betLeft">
      <div class="betTop">
        <span class="betTag">${b.method}</span>${b.date}
      </div>
      <div class="betMatch">${b.match}</div>
      <div class="betPick">${b.pick}</div>
    </div>
    <div class="betRight">
      <div class="${cls}">${txt}</div>
      <div style="font-size:13px;color:var(--muted)">${b.odds} | ${b.stake}</div>
      ${withActions?`
      <div class="actions">
        <button class="blue" onclick="showDetails(${b.id})">Dettagli</button>
        <button class="danger" onclick="deleteBet(${b.id})">Elimina</button>
      </div>`:""}
    </div>
  </div>`;
}

/* =========================
   RENDER
========================= */
function renderLatest(){
  document.getElementById("latestList").innerHTML =
    bets.slice(-5).reverse().map(b=>betCardHTML(b,false)).join("");
}
function renderHistory(){
  document.getElementById("historyList").innerHTML =
    bets.slice().reverse().map(b=>betCardHTML(b,true)).join("");
}

/* =========================
   DETAILS = FULL NOTIFICATION
========================= */
function showDetails(id){
  const b = bets.find(x=>x.id===id);
  if(!b) return;
  document.getElementById("modalTitle").innerText="Dettagli Bet";
  document.getElementById("modalBody").innerHTML =
    "<pre style='white-space:pre-wrap;font-size:13px'>"+JSON.stringify(b.notification,null,2)+"</pre>";
  document.getElementById("modalBg").style.display="flex";
}
function closeModal(){
  document.getElementById("modalBg").style.display="none";
}
function deleteBet(id){
  if(!confirm("Eliminare bet?"))return;
  localStorage.setItem("bets",JSON.stringify(bets.filter(b=>b.id!==id)));
  location.reload();
}

renderLatest();
renderHistory();
</script>
</body>
</html>
